#textdomain wesnoth-Hero_of_Irdya_I

[scenario]
    id="06_Remnant_of_the_Past"
    name= _ "Remnant of the Past"

    victory_when_enemies_defeated=yes

    {SCENARIO_MAP_DATA 1 06_Remnant_of_the_Past}
    {NEXT_SCENARIO 07_Clash_of_Five_Armies}

    {TURNS 54 50 48}
    {TIME_OVER_DEFEAT}

    {UNDERGROUND}
    {DEFAULT_MUSIC_PLAYLIST}

# No story, this level
# is a direct continuation
# of the previous one

    [side]
        side=1
        {CHARACTER_STATS_JAHIN}
        canrecruit=yes
        controller=human
        {FLAG_VARIANT ragged}
        team_name="good"
        shroud=yes
        share_view=yes
        share_map=no
        user_team_name= _ "Adventurers"
        {GOLD 500 480 480}
        {INCOME 3 2 1}
    [/side]

    [side]
        side=2
        id="Kaliban"
        name= _ "Emperor Kaliban"
        type="Death Lord"
        hitpoints={ON_DIFFICULTY 150 200 250}
        max_hitpoints={ON_DIFFICULTY 150 200 250}
        canrecruit=yes
        controller=ai
        {FLAG_VARIANT undead}
        team_name="undead"
        user_team_name= _ "Undead"
        {GOLD -980 -900 -840}
        {INCOME 13 23 28}
        recruit="Draug, Banebow, Lich Lord, Death Knight, Spectre, Nightgaunt, Skeletal Dragon"

        {LOYAL_UNIT 2 "Nightgaunt" 20 24}{GUARDIAN}
        {LOYAL_UNIT 2 "Death Knight" 23 26}{GUARDIAN}
        {LOYAL_UNIT 2 "Spectre" 26 24}{GUARDIAN}

# To discourage aerial attacks
# by Fire Ghosts and Fire Wisps

        {LOYAL_UNIT 2 "Lich Lord" 20 21}{GUARDIAN}
        {LOYAL_UNIT 2 "Lich Lord" 23 20}{GUARDIAN}
        {LOYAL_UNIT 2 "Lich Lord" 26 21}{GUARDIAN}
    [/side]

    [side]
        side=3
        id="Undead_General1"
        generate_name=no
        type="Draug"
        canrecruit=yes
        controller=ai
        {FLAG_VARIANT undead}
        team_name="undead"
        user_team_name= _ "Undead"
        # {GOLD -300 -270 -220}
        # {INCOME 13 23 28}
        # recruit="Revenant, Death Baron, Bone Shooter, Necrophage"
        {NO_ECONOMY}

        {GENERIC_UNIT 3 "Revenant" 10 17}{GUARDIAN}
        {GENERIC_UNIT 3 "Revenant" 12 17}{GUARDIAN}
    [/side]

    [side]
        side=4
        id="Undead_General2"
        generate_name=no
        type="Lich Lord"
        canrecruit=yes
        controller=ai
        {FLAG_VARIANT undead}
        team_name="undead"
        user_team_name= _ "Undead"
        # {GOLD -520 -500 -470}
        # {INCOME 18 23 33}
        # recruit="Revenant, Bone Shooter, Deathblade, Bone Knight, Necrophage, Wraith, Shadow"
        {NO_ECONOMY}

        {GENERIC_UNIT 4 "Deathmaster" 21 32}{GUARDIAN}
        {GENERIC_UNIT 4 "Deathmaster" 23 31}{GUARDIAN}
    [/side]

    [side]
        side=5
        id="Undead_General3"
        generate_name=no
        type="Elder Lich Lord"
        canrecruit=yes
        controller=ai
        {FLAG_VARIANT undead}
        team_name="undead"
        user_team_name= _ "Undead"
        # {GOLD -640 -600 -560}
        # {INCOME 18 23 33}
        # recruit="Draug, Death Knight, Banebow, Lich, Nightgaunt, Spectre, Ghast"

        {NO_ECONOMY}

        {GENERIC_UNIT 5 "Draug" 39 41}{GUARDIAN}
        {GENERIC_UNIT 5 "Death Knight" 41 40}{GUARDIAN}
    [/side]

    [side]
        side=6
        no_leader=yes
        controller=ai
        {FLAG_VARIANT undead}
        team_name="undead"
        user_team_name= _ "Undead"
        hidden=yes
        gold=0
        income=-2

# ethereal spectres
# because I have to
# screw the player now
# since this is a boss
# level

        {GENERIC_UNIT 6 "Ethereal Spectre" 16  1}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  8 12}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 14 15}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 17 21}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 11 23}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  3 28}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre"  9 36}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  6 44}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 21 44}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 21 16}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 27 17}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 21  5}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 23 10}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 25  3}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 33  2}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 43  5}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 36 12}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 43 23}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 31 33}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 32 37}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 33 41}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 43 44}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 17  7}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  7 15}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 17 12}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  1 23}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 10 25}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  3 33}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  8 38}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 11 43}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 26 31}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 30 26}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 28 14}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 22  5}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 24  1}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 26  4}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 42  1}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 43 17}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 44 27}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 34 33}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 38 37}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 29 44}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  1 13}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  6 18}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  7 20}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  4 24}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 12 25}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 15 30}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre"  2 41}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 15 44}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 27 29}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 30 22}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 32 15}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 23  9}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 26  1}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 31  4}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 43  3}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 42  7}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 42 19}{GUARDIAN}

        {GENERIC_UNIT 6 "Ethereal Spectre" 43 34}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 44 37}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Spectre" 40 44}{GUARDIAN}
        
    [/side]

# To give you a bloody
# reason why you
# should go through the teleportation
# chambers

# And, yes...I have to screw
# the player even more and
# make him cry like a little
# baby !!
 
    [side]
        side=7
        id="Undead_General4"
        generate_name=no
        type="Ethereal Nightgaunt"
        canrecruit=yes
        controller=ai
        {FLAG_VARIANT undead}
        team_name="undead"
        user_team_name= _ "Undead"
        # {GOLD -400 -360 -320}
        # {INCOME 18 23 28}
        # recruit="Ethereal Ghost, Ethereal Wraith, Ethereal Shadow, Ethereal Nightgaunt, Ethereal Spectre"

        {NO_ECONOMY}

        {GENERIC_UNIT 7 "Wraith"  8 33}{GUARDIAN}
        {GENERIC_UNIT 7 "Wraith" 13 33}{GUARDIAN}

# To eliminate chances of 
# the player being able to
# take out this leader early

        [ai]
            passive_leader=yes
        [/ai]
    [/side]

    # {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Ethereal Spectre" {ON_DIFFICULTY 1 1 2}}
    # {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Ethereal Nightgaunt" {ON_DIFFICULTY 1 1 2}}
    # {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Ethereal Wraith" {ON_DIFFICULTY 1 2 2}}
    # {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Ethereal Shadow" {ON_DIFFICULTY 1 2 2}}
    # {LIMIT_CONTEMPORANEOUS_RECRUITS 7 "Ethereal Ghost" {ON_DIFFICULTY 3 3 4}}

# More spectres because
# I haven't fucked the
# player enough

#ifndef EASY
    [event]
        name="side 6 turn 5"
        first_time_only=yes

        {GENERIC_UNIT 6 "Ethereal Wraith"  2  1}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Wraith"  1  4}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Wraith"  2  6}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Wraith"  4  8}{GUARDIAN}
        {GENERIC_UNIT 6 "Ethereal Wraith" 10  2}{GUARDIAN}

    [/event]
#endif

# Because I think that the player
# got screwed enough

    [event]
        name="die"
        first_time_only=no

        [filter_second]
            side=1
        [/filter_second]

        [sound]
            name="gold.ogg"
        [/sound]
        [floating_text]
            x,y=$x2,$y2
            text="<span color='yellow'>+{ON_DIFFICULTY 12 10 8} gold</span>"
        [/floating_text]
        [gold]
            side=1
            amount={ON_DIFFICULTY 12 10 8}
        [/gold]
    [/event]

    [event]
        name="prestart"
        first_time_only="yes"

        {RECALL "Meherab"}
        {RECALL "Mahir"}
        {RECALL "Krog"}
        {RECALL "Faria"}
        {RECALL "Maliha"}

        {RECALL "Kojac"}
        {RECALL "Crylix"}
        {RECALL "rider1"}
        {RECALL "rider2"}
        {RECALL "Nog"}

        {VARIABLE scroll_found no}

        [objectives]
            side=1
            silent=no

           [objective]
               description= _ "Find and destroy Emperor Kaliban"
               condition="win"
           [/objective]

           [objective]
                description= _ "Death of Jahin"
                condition="lose"
           [/objective]

           [objective]
                description= _ "Death of any hero unit"
                condition="lose"
           [/objective]

           [carryover]
                bonus=no
                carryover_percentage=40
           [/carryover]

           [note]
                description= _ "To activate the rotating platforms, you need to find their respective switches. Switches are identical to runes (glowing or non-glowing)."
           [/note]
           [note] 
                description= _ "For every undead your units destroy, you will be rewarded with a diminutive amount of gold."
           [/note]
        [/objectives]

        [object]
            [effect]
                apply_to=attack
                type=blade
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]

            [filter]
                id="Jahin"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-40
                [/resistance]
            [/effect]
            
            [filter]
                id="Krog"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]
            
            [filter]
                id="Faria"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=attack
                type=blade
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]

            [filter]
                id="Mahir"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=attack
                type=blade
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]

            [filter]
                id="Meherab"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=attack
                type=blade
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]

            [filter]
                id="Kojac"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=attack
                type=blade
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]

            [filter]
                id="rider1"
            [/filter]
            duration=scenario
            silent=yes
        [/object]

        [object]
            [effect]
                apply_to=attack
                type=blade
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                [resistance]
                    arcane=-20
                [/resistance]
            [/effect]

            [filter]
                id="rider2"
            [/filter]
            duration=scenario
            silent=yes
        [/object]
    [/event]

    {ENABLE_AREA_ROTATION}

    {HOI1_PLACE_SWITCH 42 27 1}
    {HOI1_SPINNING_ISLE 35 24 2 1}

    {HOI1_PLACE_SWITCH 40 22 2}
    {HOI1_SPINNING_ISLE 37 18 2 2}

    {HOI1_PLACE_SWITCH 31 18 3}
    {HOI1_SPINNING_ISLE 36  5 2 3}

    {HOI_TELEPORTATION_RUNES 1 1  5 31  7 43}
    {HOI_TELEPORTATION_RUNES 1 2  9 40 13 42}
    {HOI_TELEPORTATION_RUNES 1 3 17 39 17 36}
    {HOI_TELEPORTATION_RUNES 1 4 16 32 21 38}
    {HOI_TELEPORTATION_RUNES 1 5 19 36 15 37}
    {HOI_TELEPORTATION_RUNES 1 6 10 37 13 33}
    {HOI_TELEPORTATION_RUNES 1 1  8 33  5 42}
    {HOI_TELEPORTATION_RUNES 1 2  4 38  7 35}
    {HOI_TELEPORTATION_RUNES 1 3  3 36 18 40}

    {MAIN_HERO_DEATH_EVENTS}
    {MAHIR_DEATH_EVENT}
    {FARIA_DEATH_EVENT}
    {KOJAC_LOYAL_DEATH_EVENT}
    {LOYAL_UNIT_DEATH_EVENT}

    [event]
        name="start"
        first_time_only=yes

        {SIMPLE_MESSAGE "Faria" ( _ "Ugh — this emperor's lair is even more malodorous than I had previously imagined!")}

        {SIMPLE_MESSAGE "Jahin" ( _ "Everyone, advance with caution. I have a feeling that we could get ambushed at any moment!")}
    [/event]

    {PLACE_IMAGE "items/chest.png" 39  3}

    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            id="Mahir"
            [filter_adjacent]
                id="Faria"
            [/filter_adjacent]
            [or]
                id="Faria"
                [filter_adjacent]
                    id="Mahir"
                [/filter_adjacent]
            [/or]
        [/filter]

        {SIMPLE_MESSAGE "Mahir" ( _ "Hey Faria, I need to say something to you.")}

        {SIMPLE_MESSAGE "Faria" ( _ "What is it, Mahir?")}

        {SIMPLE_MESSAGE "Mahir" ( _ "<i>(smiling)</i> I know...")}

        {SIMPLE_MESSAGE "Faria" ( _ "What do you know about?")}

        {SIMPLE_MESSAGE "Mahir" ( _ "<i>(chuckling)</i> You will find out soon enough...")}
    [/event]

    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            side=1
            [not]
                id="Mahir"
            [/not]
            x,y=39, 3
        [/filter]

        {SIMPLE_MESSAGE "Jahin" ( _ "Hey everybody, look! There's a decorated chest there. I wonder what might be inside.")}

        {SIMPLE_MESSAGE "Mahir" ( _ "Let me check it out.")}
    [/event]

    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            side=1
            id="Mahir"
            x,y=39, 3
        [/filter]
 
        {SIMPLE_MESSAGE "Mahir" ( _ "It's a chest. <i>(opens chest)</i> There's a scroll inside.")}

        {SIMPLE_MESSAGE "Faria" ( _ "What's written on it?")}

        {SIMPLE_MESSAGE "Mahir" ( _ "<i>(reading the scroll)</i> Faria is madly in love with Jahin!")}

        {SIMPLE_MESSAGE "Faria" ( _ "What?!")}

        {SIMPLE_MESSAGE "Mahir" ( _ "<i>(laughing)</i> I'm just joking! The scroll is written in a language that I am unable to read.")}

        {SIMPLE_MESSAGE "Jahin" ( _ "It might be useful. Let's take it.")}

        {VARIABLE scroll_found yes}

        {REMOVE_IMAGE 39 3}
        
    [/event]

    {ON_SIGHTING one 1 (id="Kaliban") (
        {SIMPLE_MESSAGE "Kaliban" ( _ "What do we have here? Young ones, do you actually think that you can defeat me? I am the Emperor of Arkenova and a remnant of the First Elemental War! Surrender now, and I shall offer you all a merciless death!")}

        {SIMPLE_MESSAGE "Jahin" ( _ "We do not give a crap about who are! We will thwart your plans of destroying the world!")}

        [gold]
            side=2
            amount={ON_DIFFICULTY 180 210 240}
        [/gold]

    )}


   [event]
        name="last breath"

        [filter]
            id="Kaliban"
        [/filter]

        {SIMPLE_MESSAGE "Kaliban" ( _ "No! I have been bested. However, do not celebrate this victory. My resurrection was caused by the awakening of an ancient evil. I can still feel him aggrandising in strength, his armies slowly advancing on the various landmasses, and the number of his living followers grows exponentially. None of you will survive his wrath!")}
   [/event]

   [event]
        name="die"

        [filter]
            id="Kaliban"
        [/filter]

        {NARRATOR_MESSAGE ( _ "The colossal undead warrior crumbles to dust. The remaining undead, perceiving the destruction of their warlord, retreat into the shadows...")}

        [kill]
            side=2
            animate=no
        [/kill]
        [kill]
            side=3
            animate=no
        [/kill]
        [kill]
            side=4
            animate=no
        [/kill]
        [kill]
            side=5
            animate=no
        [/kill]
        [kill]
            side=6
            animate=no
        [/kill]
        [kill]
            side=7
            animate=no
        [/kill]

        {SIMPLE_MESSAGE "Meherab" ( _ "We have won! The undead have been vanquished!")}

        {SIMPLE_MESSAGE "Jahin" ( _ "What about the things he said? What if there is an ancient evil that wishes to destroy the world?")}

        {SIMPLE_MESSAGE "Faria" ( _ "I am sure that he was just bluffing. He was defeated and this prompted him to utter such things to instil fear in our minds.")}

        {SIMPLE_MESSAGE "Mahir" ( _ "Let's return to Chief Tuug's camp. The trolls must have scattered the remaining undead inside the lower caverns by now.")}

        [endlevel]
            result="victory"
            {NEW_GOLD_CARRYOVER 40}
            bonus=yes
        [/endlevel]
   [/event]

# Not sure if this is even possible, but I am 
# including it here anyways

   [event]
        name="enemies defeated"
     
        [endlevel]
            result="victory"
            {NEW_GOLD_CARRYOVER 40}
            bonus=yes
        [/endlevel]
   [/event]

   {CUSTOM_ADVANCEMENTS}
   {DIVINE_ENCHANTMENT}
[/scenario]