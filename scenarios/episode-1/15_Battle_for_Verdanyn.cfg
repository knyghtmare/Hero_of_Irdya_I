[scenario]
    id = 15_Battle_for_Verdanyn
    name = _ "Battle for Verdanyn"

    victory_when_enemies_defeated = no

    {SCENARIO_MAP_DATA 1 15_Battle_for_Verdanyn}
    {NEXT_SCENARIO 15x_Aftermath}

    {TURNS 29 27 25}

    # defining a custom schedule
    {DEFAULT_SCHEDULE_CLOUD_SET}

    {DEFAULT_MUSIC_PLAYLIST}

    {STORY_TEXT_SCENARIO_15}

    [side]
        side=1
        {CHARACTER_STATS_JAHIN}
        canrecruit=yes
        controller=human
        {FLAG_VARIANT loyalist}
        team_name="good"
        fog=no
        user_team_name= _ "Alliance"
        {GOLD 380 350 320}
        {INCOME 3 2 1}
    [/side]

    {STARTING_VILLAGES 1 6}

    # Vampire Sides

    [side]
        side = 2
        id = Phaelyn
        name = _ "Lady Phaelyn"
        type = Duchess
        canrecruit = yes
        controller = ai
        hitpoints={ON_DIFFICULTY 120 150 180}
        max_hitpoints={ON_DIFFICULTY 120 150 180}
        {FLAG_VARIANT long}
        team_name = "vampires"
        user_team_name = _ "Vampires"

        {GOLD 800 960 1100}
        {INCOME 38 48 58}

        recruit = "Sangel, Sword Dancer, Flesh Artisan, Sire, Mistress, Twilight Walker, Day Hunter, Blood Hulk"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 2 20}

    [event]
        name="last breath"
        [filter]
            id="Phaelyn"
        [/filter]

        {SIMPLE_MESSAGE "Phaelyn" ( _ "No, this cannot be happening!")}
    [/event]

    # death event for eradicating
    # the main vampire leader
    [event]
        name="die"
        [filter]
            id="Phaelyn"
        [/filter]

        {SIMPLE_MESSAGE "Jahin" ( _ "Ah, the vampire duchess has fallen! Now, we must take back the keep!")}
    [/event]

    [side]
        side = 3
        id = Vampire_Leader1
        generic_name = yes
        type = Sire
        canrecruit = yes
        controller = ai
        {FLAG_VARIANT long}
        team_name = "vampires"
        user_team_name = _ "Vampires"

        {GOLD 720 840 960}
        {INCOME 38 48 58}

        recruit = "Blood Manipulator, Blood Hulk, Vampire Duelist, Vampire Noble, Half Blood, Flesh Artisan"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 3 6}

    [side]
        side = 4
        id = Vampire_Leader2
        generic_name = yes
        type = Mistress
        canrecruit = yes
        controller = ai
        {FLAG_VARIANT long}
        team_name = "vampires"
        user_team_name = _ "Vampires"

        {GOLD 720 840 960}
        {INCOME 38 48 58}

        recruit = "Blood Manipulator, Blood Hulk, Vampire Duelist, Vampire Noble, Half Blood, Flesh Artisan"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 4 6}

    [side]
        side = 5
        id = Vampire_Leader3
        generic_name = yes
        type = Twilight Walker
        canrecruit = yes
        controller = ai
        {FLAG_VARIANT long}
        team_name = "vampires"
        user_team_name = _ "Vampires"

        {GOLD 720 840 960}
        {INCOME 38 48 58}

        recruit = "Blood Manipulator, Blood Hulk, Vampire Duelist, Vampire Noble, Half Blood, Flesh Artisan"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 5 6}

    [side]
        side = 6
        id = Vampire_Leader4
        generic_name = yes
        type = Sangel
        canrecruit = yes
        controller = ai
        {FLAG_VARIANT long}
        team_name = "vampires"
        user_team_name = _ "Vampires"

        {GOLD 720 840 960}
        {INCOME 38 48 58}

        recruit = "Blood Manipulator, Blood Hulk, Vampire Duelist, Vampire Noble, Half Blood, Flesh Artisan"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 6 6}

    # Allied Sides

    [side]
        side = 7
        canrecruit = yes
        controller = ai

        {FLAG_VARIANT loyalist}
        team_name = "good"
        user_team_name = _ "Drakes"

        id="Kerath"
        name= _ "Kerath Mah Toa"
        type="Drake Enforcer"

        {GOLD 500 480 450}
        {INCOME 48 38 38}

        recruit = "Drake Warrior, Fire Drake, Drake Arbiter, Drake Thrasher, Saurian Ambusher, Saurian Soothsayer"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 7 6}

    # death events for Drake General
    [event]
        name="last breath"
        [filter]
            id="Kerath"
        [/filter]

        {SIMPLE_MESSAGE "Jahin" ( _ "Oh, no! Without our drake allies, we shall surely be overwhelmed!")}
    [/event]

    [event]
        name="die"
        [filter]
            id="Kerath"
        [/filter]

        {ENDLEVEL_DEFEAT}
    [/event]

    [side]
        side = 8
        id = "Radoc"
        name = _ "Prince Radoc"
        type = "Minotaur Overlord"
        canrecruit = yes
        controller = ai
        team_name="good"
        user_team_name= _ "Minotaurs"

        {FLAG_VARIANT long}
        {GOLD 500 480 450}
        {INCOME 48 38 38}

        recruit = "Minotaur Rouser, Minotaur Mystic, Minotaur Slayer, Minotaur Warlock, Minotaur Savage, Minotaur Ancient Behemoth, Boar Knight, Gnoll Marksman"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 8 6}

    # death events of Prince Radoc
    [event]
        name="last breath"
        [filter]
            id="Radoc"
        [/filter]

        {SIMPLE_MESSAGE "Jahin" ( _ "No! We needed to keep him alive!")}
    [/event]

    [event]
        name="die"
        [filter]
            id="Radoc"
        [/filter]

        {ENDLEVEL_DEFEAT}
    [/event]

    [side]
        side = 9
        id = "Tuug"
        name = _ "Great Chief Tuug"
        type = "Troll Warmonger"
        canrecruit = yes
        controller = ai

        team_name="good"
        user_team_name= _ "Trolls"

        {FLAG_VARIANT long}
        {GOLD 500 480 450}
        {INCOME 48 38 38}

        recruit = "Troll Warrior, Troll, Troll Rocklobber, Troll Boulderlobber, Troll Shaman"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 9 8}

    # death events of Tuug
    [event]
        name="last breath"
        [filter]
            id="Tuug"
        [/filter]

        {SIMPLE_MESSAGE "Jahin" ( _ "We needed to keep him alive!")}
    [/event]

    [event]
        name="die"
        [filter]
            id="Tuug"
        [/filter]

        {ENDLEVEL_DEFEAT}
    [/event]

    # Orcs

    [side]
        side = 10
        team_name = "orcs"
        user_team_name = _ "Northern Orcs"
        {FLAG_VARIANT ragged}
        color = rust

        type = "Orcish Overlord"
        id = "Orc_Chieftain"
        generic_name = yes
        canrecruit = yes
        controller = ai
        x,y = 3,22

        {GOLD 700 880 1050}
        {INCOME 38 38 38}

        recruit = "Orcish Warlord, Orcish Sovereign, Orcish Slurbow, Orcish Terror, Orcish Elite Warrior, Orcish Nightblade, Orcish Sorcerer, Direwolf Rider, Goblin Cutthroat"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 10 6}

    [side]
        side = 11
        team_name = "orcs"
        user_team_name = _ "Northern Orcs"
        {FLAG_VARIANT ragged}

        type = "Orcish Sovereign"
        id = "Orc_Leader1"
        color = yellow
        generic_name = yes
        canrecruit = yes
        controller = ai
        [modifications]
            {TRAIT_DEFENDER}
        [/modifications]
        x,y = 3,12

        {GOLD 500 580 650}
        {INCOME 38 38 38}

        recruit = "Orcish Warrior, Orcish Crossbowman, Goblin Knight, Goblin Pillager, Orcish Slayer, Orcish Raider, Orcish Warlock"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 11 6}

    [side]
        side = 12
        team_name = "orcs"
        user_team_name = _ "Northern Orcs"
        {FLAG_VARIANT ragged}
        color = pink

        type = "Orcish Sovereign"
        id = "Orc_Leader2"
        # this was given
        # because this leader
        # shameless moves to his ally
        # never returns to his keep
        [modifications]
            {TRAIT_DEFENDER}
        [/modifications]
        generic_name = yes
        canrecruit = yes
        controller = ai
        x,y = 7,11

        {GOLD 500 580 650}
        {INCOME 38 38 38}

        recruit = "Orcish Warrior, Orcish Crossbowman, Goblin Knight, Goblin Pillager, Orcish Slayer, Orcish Raider, Orcish Warlock"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {STARTING_VILLAGES 12 6}

    # Quenoth Elves & Demons

    [side]
        side = 13
        team_name = "elves"
        user_team_name = _ "Quenoth Elves"
        {FLAG_VARIANT long}
        color = khaki

        type = "Tauroch Flagbearer"
        id = "Elf_Leader1"
        generic_name = yes
        canrecruit = yes
        controller = ai
        x,y = 3,64

        {GOLD 500 580 650}
        {INCOME 38 38 38}

        recruit = "Quenoth Shaman, Quenoth Sun Singer, Quenoth Archer, Quenoth Pathfinder, Tauroch Stalwart, Tauroch Vanguard, Quenoth Warrior, Quenoth Flanker, Demon, Demon Grunt, Demon Zephyr"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    [side]
        side = 14
        team_name = "elves"
        user_team_name = _ "Demons"
        {FLAG_VARIANT long}
        color = dark_purple

        type = "Demon Executioner"
        id = "Demon_Leader1"
        generic_name = yes
        canrecruit = yes
        controller = ai
        x,y = 9,64

        {GOLD 700 880 1050}
        {INCOME 38 38 38}

        recruit = "Demon Warrior, Demon Zephyr, Demon Spelldancer, Demon Stormtide, Lumeril Guard"
        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    # Dark Elementalist faction

    [side]
        side = 15
        team_name = "evil"
        user_team_name = _ "Undead"
        {FLAG_VARIANT undead}
        color = orchid

        id = "Undead_Lord"
        generic_name = yes
        type = "Elder Lich Lord"
        canrecruit = yes
        controller = ai
        x,y = 43,64

        {GOLD 700 880 1050}
        {INCOME 38 48 58}

        recruit = "Shadowback, Spectre, Draug, Dark Invader, Banebow, Death Knight, Death Lord"

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]

        # just for laughs
        {GENERIC_UNIT 15 "Chocobone" 43 64}
        {GENERIC_UNIT 15 "Chocobone" 43 64}
        {GENERIC_UNIT 15 "Chocobone" 43 64}
        {GENERIC_UNIT 15 "Chocobone" 43 64}
        {GENERIC_UNIT 15 "Chocobone" 43 64}
        {GENERIC_UNIT 15 "Chocobone" 43 64}
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 15 "Spectre" {ON_DIFFICULTY 2 3 4}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 15 "Shadowback" {ON_DIFFICULTY 2 3 4}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 15 "Death Lord" {ON_DIFFICULTY 1 2 3}}

    [side]
        side = 16
        team_name = "evil"
        user_team_name = _ "Elementals"
        {FLAG_VARIANT undead}
        color = medium_orchid

        id = "Undead_Leader1"
        generic_name = yes
        type = "Lich Lord"
        canrecruit = yes
        controller = ai
        x,y = 52,60

        {GOLD 600 750 900}
        {INCOME 38 38 38}

        recruit = "Furnace Beast, Fire Wisp, Stone Golem, Vine Tiger, Zephyr, Thunderbird"

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 16 "Fire Wisp" {ON_DIFFICULTY 2 3 4}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 16 "Thunderbird" {ON_DIFFICULTY 2 3 4}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 16 "Stone Golem" {ON_DIFFICULTY 2 3 4}}

    [side]
        side = 17
        team_name = "evil"
        user_team_name = _ "Nightmares"
        {FLAG_VARIANT undead}
        color = steel_blue

        id = "Undead_Leader2"
        generic_name = yes
        type = "Lich"
        canrecruit = yes
        controller = ai
        x,y = 58,60

        {GOLD 600 750 900}
        {INCOME 38 38 38}

        recruit = "Angry One, Spiteful Watcher, Jinx Beast, Rash One, Cloud of Gloom, Soul Snatcher"

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.77}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.34}
        [/ai]
    [/side]

    # Vampire Guardian Side

    [side]
        side = 18
        no_leader = yes
        hidden = yes
        color = vivid_blue
        controller = ai
        team_name = "vampires"
        {FLAG_VARIANT long}
        {NO_ECONOMY}

        # keep

        {GENERIC_UNIT 18 "Methusalem" 31 39}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Methusalem" 33 39}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Methusalem" 31 42}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Methusalem" 33 42}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Methusalem" 34 40}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Methusalem" 30 40}{HOI_IMPROVED_GUARDIAN}

        # inner wall

        {GENERIC_UNIT 18 "Sword Dancer" 21 31}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sire" 23 30}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Mistress" 30 28}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 33 29}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Twilight Walker" 17 48}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Day Hunter" 17 47}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Sword Dancer" 18 45}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sire" 19 45}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Mistress" 23 50}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 21 50}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Twilight Walker" 36 49}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Day Hunter" 40 47}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Sword Dancer" 41 49}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sire" 23 45}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Mistress" 25 47}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 28 47}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Twilight Walker" 30 47}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Day Hunter" 33 47}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Sword Dancer" 36 46}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sire" 39 45}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Mistress" 39 43}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 39 42}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Twilight Walker" 39 40}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Day Hunter" 38 37}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Sword Dancer" 37 35}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sire" 31 35}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Mistress" 29 34}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 26 34}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Twilight Walker" 24 35}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Day Hunter" 25 38}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Mistress" 24 40}{HOI_IMPROVED_GUARDIAN}

        # black castle guards

        {GENERIC_UNIT 18 "Sangel" 5 29}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 3 31}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 7 32}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 7 31}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 19 28}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 20 27}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Sangel" 17 36}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 19 39}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 15 43}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 12 48}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 39 28}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 40 28}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Sangel" 33 25}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 34 25}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Sangel" 29 25}{HOI_IMPROVED_GUARDIAN}

        # outer wall

        {GENERIC_UNIT 18 "Vampire Noble" 22 19}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 24 17}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 27 16}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 29 15}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 33 15}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 35 17}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 38 17}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Vampire Noble" 40 18}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 42 21}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 43 23}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 43 26}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 43 29}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 42 32}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 43 35}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Vampire Noble" 43 40}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 43 43}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 46 45}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 47 49}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 46 51}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 44 54}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 30 53}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Vampire Noble" 26 54}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 22 55}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 19 56}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 16 57}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 12 28}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 10 56}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 6 56}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Vampire Noble" 5 56}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 4 52}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 7 50}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 9 49}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 10 46}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 8 45}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 5 43}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Vampire Noble" 2 40}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 5 38}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 6 35}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 7 35}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 10 33}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 11 31}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 11 29}{HOI_IMPROVED_GUARDIAN}

        {GENERIC_UNIT 18 "Vampire Noble" 12 58}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Duelist" 11 27}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Manipulator" 11 24}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Flesh Artisan" 12 22}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Blood Hulk" 13 22}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Half Blood" 15 21}{HOI_IMPROVED_GUARDIAN}
        {GENERIC_UNIT 18 "Vampire Noble" 16 20}{HOI_IMPROVED_GUARDIAN}
    [/side]

    # Alliance Soldiers Side

    [side]
        side = 19
        no_leader = yes
        controller = ai
        {FLAG_VARIANT long}
        color = dodger_blue
        team_name = "good"
        hidden = yes
        {NO_ECONOMY}

        # alliance soldiers

        {GENERIC_UNIT 19 "Drake Enforcer" 31 6}
        {GENERIC_UNIT 19 "Drake Arbiter" 31 6}
        {GENERIC_UNIT 19 "Minotaur Savage" 31 6}
        {GENERIC_UNIT 19 "Dwarvish Lord" 31 6}
        {GENERIC_UNIT 19 "Saurian Ambusher" 31 6}
        {GENERIC_UNIT 19 "Dwarvish Runemaster" 31 6}
        {GENERIC_UNIT 19 "Troll Rocklobber" 31 6}

        {GENERIC_UNIT 19 "Drake Thrasher" 40 8}
        {GENERIC_UNIT 19 "Drake Arbiter" 40 8}
        {GENERIC_UNIT 19 "Minotaur Savage" 40 8}
        {GENERIC_UNIT 19 "Minotaur Mystic" 40 8}
        {GENERIC_UNIT 19 "Gryphon Thunderlord" 40 8}
        {GENERIC_UNIT 19 "Troll Warrior" 40 8}
        {GENERIC_UNIT 19 "Troll Rocklobber" 40 8}

        {GENERIC_UNIT 19 "Drake Thrasher" 48 2}
        {GENERIC_UNIT 19 "Drake Arbiter" 48 2}
        {GENERIC_UNIT 19 "Minotaur Savage" 48 2}
        {GENERIC_UNIT 19 "Minotaur Mystic" 48 2}
        {GENERIC_UNIT 19 "Gryphon Master" 48 2}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 48 2}
        {GENERIC_UNIT 19 "Troll Rocklobber" 48 2}

        {GENERIC_UNIT 19 "Drake Thrasher" 51 11}
        {GENERIC_UNIT 19 "Drake Arbiter" 51 11}
        {GENERIC_UNIT 19 "Minotaur Savage" 51 11}
        {GENERIC_UNIT 19 "Minotaur Mystic" 51 11}
        {GENERIC_UNIT 19 "Saurian Ambusher" 51 11}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 51 11}
        {GENERIC_UNIT 19 "Troll Rocklobber" 51 11}

        {GENERIC_UNIT 19 "Drake Thrasher" 45 9}
        {GENERIC_UNIT 19 "Drake Arbiter" 45 9}
        {GENERIC_UNIT 19 "Minotaur Savage" 45 9}
        {GENERIC_UNIT 19 "Minotaur Mystic" 45 9}
        {GENERIC_UNIT 19 "Saurian Ambusher" 45 9}
        {GENERIC_UNIT 19 "Troll Warrior" 45 9}
        {GENERIC_UNIT 19 "Troll Rocklobber" 45 9}

        {GENERIC_UNIT 19 "Drake Thrasher" 59 2}
        {GENERIC_UNIT 19 "Drake Arbiter" 59 2}
        {GENERIC_UNIT 19 "Gryphon Thunderlord" 59 2}
        {GENERIC_UNIT 19 "Minotaur Mystic" 59 2}
        {GENERIC_UNIT 19 "Saurian Ambusher" 59 2}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 59 2}
        {GENERIC_UNIT 19 "Troll Rocklobber" 59 2}

        {GENERIC_UNIT 19 "Drake Thrasher" 56 6}
        {GENERIC_UNIT 19 "Drake Arbiter" 56 6}
        {GENERIC_UNIT 19 "Minotaur Savage" 56 6}
        {GENERIC_UNIT 19 "Minotaur Mystic" 56 6}
        {GENERIC_UNIT 19 "Saurian Ambusher" 56 6}
        {GENERIC_UNIT 19 "Dwarvish Explorer" 56 6}
        {GENERIC_UNIT 19 "Troll Rocklobber" 56 6}

        {GENERIC_UNIT 19 "Drake Thrasher" 56 14}
        {GENERIC_UNIT 19 "Drake Arbiter" 56 14}
        {GENERIC_UNIT 19 "Minotaur Savage" 56 14}
        {GENERIC_UNIT 19 "Minotaur Mystic" 56 14}
        {GENERIC_UNIT 19 "Saurian Ambusher" 56 14}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 56 14}
        {GENERIC_UNIT 19 "Troll Rocklobber" 56 14}

        {GENERIC_UNIT 19 "Drake Thrasher" 52 17}
        {GENERIC_UNIT 19 "Drake Arbiter" 52 17}
        {GENERIC_UNIT 19 "Minotaur Savage" 52 17}
        {GENERIC_UNIT 19 "Minotaur Mystic" 52 17}
        {GENERIC_UNIT 19 "Saurian Ambusher" 52 17}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 52 17}
        {GENERIC_UNIT 19 "Troll Rocklobber" 52 17}

        {GENERIC_UNIT 19 "Saurian Flanker" 57 24}
        {GENERIC_UNIT 19 "Drake Warrior" 57 24}
        {GENERIC_UNIT 19 "Hurricane Drake" 57 24}
        {GENERIC_UNIT 19 "Minotaur Mystic" 57 24}
        {GENERIC_UNIT 19 "Saurian Ambusher" 57 24}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 57 24}
        {GENERIC_UNIT 19 "Troll Rocklobber" 57 24}

        {GENERIC_UNIT 19 "Drake Thrasher" 9 2}
        {GENERIC_UNIT 19 "Drake Arbiter" 9 2}
        {GENERIC_UNIT 19 "Minotaur Savage" 9 2}
        {GENERIC_UNIT 19 "Minotaur Mystic" 9 2}
        {GENERIC_UNIT 19 "Gryphon Master" 9 2}
        {GENERIC_UNIT 19 "Dwarvish Pathfinder" 9 2}
        {GENERIC_UNIT 19 "Troll Rocklobber" 9 2}
    [/side]

    # preload event

    [event]
        name=preload
        first_time_only=no

        # focus Jahin
        # reasons:
        # the main guy
        [lua]
            code=<<
                function hero_of_irdya(unit)
                    if (unit.id == "Jahin") then
                        return true
                    else
                        return false
                    end
                end
            >>
        [/lua]

        # Lua function to prioritise 
        # higher level units
        [lua]
            code=<<
                function high_level_unit(unit)
                    if (unit.level >= 2) then
                        return true
                    else
                        return false
                    end
                end
            >>
        [/lua]
    [/event]

    # prestart
    [event]
        name = "prestart"

        [allow_recruit]
            side = 1
            type = "Infantryman, Spearman, Bowman, Heavy Infantryman, Horseman, Adept of Light"
        [/allow_recruit]

        # introduce Abrar
        # persistent hero
        [unit]
            {CHARACTER_STATS_ABRAR}
            x,y = 41, 4
            experience={ON_DIFFICULTY 32 21 11}
        [/unit]

        # objective
        [objectives]
            side = 1
            silent = no
            [objective]
                caption= _ "Main Objective:"
                description = _ "Defeat all enemy leaders"
                condition = win
            [/objective]
            [objective]
                caption= _ "Bonus Objective:"
                description = _ "Move Jahin to the Keep of Verdanyn (32,40)"
                condition = win
                [show_if]
                    {VARIABLE_CONDITIONAL keep_captured equals no}
                [/show_if]
            [/objective]
            [objective]
                description = _ "Death of Jahin"
                condition = lose
            [/objective]
            [objective]
                description = _ "Death of any allied leader"
                condition = lose
            [/objective]
            [objective]
                description = _ "Death of any hero unit"
                condition = lose
            [/objective]
            {TURNS_RUN_OUT}
            [carryover]
                carryover_percentage=40
                bonus=yes
            [/carryover]
            {IS_LAST_SCENARIO}
        [/objectives]

        {RECALL "Krog"}
        {RECALL "Meherab"}
        {RECALL "Mahir"}

        {RECALL "Fah Ra Din"}
        {RECALL "Kojac"}
        {RECALL "Crylix"}
        {RECALL "rider1"}
        {RECALL "rider2"}
        {RECALL "Nog"}
        {RECALL "soldier"}
        {RECALL "soldier2"}

        {RECALL "Varawiel"}
        {RECALL "Sylwester"}
        {RECALL "Loyal_Ghost"}

        # micro AI code

        [micro_ai]
            side=7
            ai_type=healer_support
            action=add
            [filter]
                type="Saurian Soothsayer"
            [/filter]
            aggression=0.10
        [/micro_ai]

        [micro_ai]
            side=8
            ai_type=healer_support
            action=add
            [filter]
                type="Minotaur Mystic"
            [/filter]
            aggression=0.10
        [/micro_ai]

        [micro_ai]
            side=13
            ai_type=healer_support
            action=add
            [filter]
                type="Quenoth Shaman"
            [/filter]
            aggression=0.10
        [/micro_ai]

        [micro_ai]
            side=19
            ai_type=healer_support
            action=add
            [filter]
                type="Minotaur Mystic"
            [/filter]
            aggression=0.10
        [/micro_ai]

        # micro AI
        # vampires are on defensive
        [micro_ai]
            side=2
            ai_type=zone_guardian
            action=add

            [filter]
                side=2
                canrecruit=no
            [/filter]
            [filter_location]
                x=9-42
                y=22-55
                terrain=G*,R*,C*,K*,*^V*
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=zone_guardian
            action=add

            [filter]
                side=3
                canrecruit=no
            [/filter]
            [filter_location]
                x=28-60
                y=55-65
                terrain=G*,R*,C*,K*,*^V*
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=4
            ai_type=zone_guardian
            action=add

            [filter]
                side=4
                canrecruit=no
            [/filter]
            [filter_location]
                x=1-30
                y=50-65
                terrain=G*,R*,C*,K*,*^V*
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=6
            ai_type=zone_guardian
            action=add

            [filter]
                side=6
                canrecruit=no
            [/filter]
            [filter_location]
                x=25-40
                y=19-25
                terrain=G*,R*,C*,K*,*^V*
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=5
            ai_type=zone_guardian
            action=add

            [filter]
                side=5
                canrecruit=no
            [/filter]
            [filter_location]
                x=11-19
                y=24-30
                terrain=G*,R*,C*,K*,*^V*
            [/filter_location]
        [/micro_ai]

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "high_level_unit"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "high_level_unit"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=4
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "high_level_unit"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=5
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "high_level_unit"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=6
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "high_level_unit"
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=18
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "high_level_unit"
            [/filter_second]
        [/micro_ai]

        # vampires will focus
        # jahin as he is the
        # commander of the assault
        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add

            ca_score=110002
            [filter_second]
                lua_function = "hero_of_irdya"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add

            ca_score=110001
            [filter_second]
                lua_function = "hero_of_irdya"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=4
            ai_type=simple_attack
            action=add

            ca_score=110002
            [filter_second]
                lua_function = "hero_of_irdya"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=5
            ai_type=simple_attack
            action=add

            ca_score=110002
            [filter_second]
                lua_function = "hero_of_irdya"
            [/filter_second]
        [/micro_ai]
        [micro_ai]
            side=6
            ai_type=simple_attack
            action=add

            ca_score=110002
            [filter_second]
                lua_function = "hero_of_irdya"
            [/filter_second]
        [/micro_ai]

        # fast micro AI
        # for allies

        [micro_ai]
            side=7
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=8
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=9
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=19
            ai_type=fast_ai
            action=add
        [/micro_ai]

        # recruitment random
        # for allies
        [micro_ai]
            side=7
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=8
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=9
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]

        # orcs
        # fast Micro AI
        # and recruitment random
        [micro_ai]
            side=10
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=11
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=12
            ai_type=fast_ai
            action=add
        [/micro_ai]

        [micro_ai]
            side=10
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=11
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=12
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]

        # demons and quenoth

        [micro_ai]
            side=13
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=14
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=13
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=14
            ai_type=fast_ai
            action=add
        [/micro_ai]

        # dark elementalist
        [micro_ai]
            side=15
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=16
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=17
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=15
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=16
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]
        [micro_ai]
            side=17
            ai_type=recruit_random
            action=add
            skip_low_gold_recruiting=yes
        [/micro_ai]

        {VARIABLE keep_captured no}
    [/event]

    {SET_LABEL 32 40 ( _ "Keep of Verdanyn")}

    # start event
    [event]
        name="start"

        {SIMPLE_MESSAGE "Jahin" ( _ "Abrar! Nice to see that you have escaped as well!")}

        {SIMPLE_MESSAGE "Abrar" ( _ "Aye, friend. It's good to be free! I see that you have brought forth an army to free our home from the blood-sucking menace.")}

        {SIMPLE_MESSAGE "Jahin" ( _ "Are there any more with you?")}

        {SIMPLE_MESSAGE "Abrar" ( _ "A few others, yes. We are ready to fight alongside you!")}
    [/event]

    # special event
    [event]
        name = "moveto"
        first_time_only = yes
        [filter]
            id = "Jahin"
            x,y = 32,40
        [/filter]

        {SIMPLE_MESSAGE "Jahin" ( _ "We have captured the keep! Friends and allies, have heart for we have almost reigned victorious!")}

        {VARIABLE keep_captured yes}

        {GENERIC_UNIT 19 {ON_DIFFICULTY "Prowler" "Huntress" "Huntress"} 32 40}{ASSIGN_ID "liberated_human"}
        {GENERIC_UNIT 19 {ON_DIFFICULTY "Fugitive" "Outlaw" "Outlaw"} 32 40}
        {GENERIC_UNIT 19 {ON_DIFFICULTY "Huntsman" "Trapper" "Poacher"} 32 40}
        {GENERIC_UNIT 19 {ON_DIFFICULTY "Axemaster" "Axeman" "Axethrower"} 32 40}
        {GENERIC_UNIT 19 {ON_DIFFICULTY "Highwayman" "Bandit" "Bandit"} 32 40}
        {GENERIC_UNIT 19 {ON_DIFFICULTY "Outlaw" "Outlaw" "Footpad"} 32 40}

        {SIMPLE_MESSAGE "liberated_human" ( _ "Thank you, Jahin. We fight for you now!")}

        [show_objectives]
        [/show_objectives]
    [/event]

    # enemies defeated
    [event]
        name = "enemies defeated"

        #[if]
        #    {VARIABLE_CONDITIONAL keep_captured equals yes}
        #    [then]
        #        {SIMPLE_MESSAGE "Jahin" ( _ "It has finally ended. We have triumphed!")}
        #
        #        [endlevel]
        #            result = victory
        #        [/endlevel]
        #    [/then]
        #    [else]
        #        {SIMPLE_MESSAGE "Jahin" ( _ "We have to capture the keep to assert our victory!")}
        #    [/else]
        #[/if]

        {SIMPLE_MESSAGE "Jahin" ( _ "It has finally ended. We have triumphed!")}

        {SIMPLE_MESSAGE "Mahir" ( _ "Verdanyn has been liberated!")}

        [endlevel]
            result=victory
            {NEW_GOLD_CARRYOVER 40}
            bonus=yes
        [/endlevel]
    [/event]

    # capture

    [event]
        name = "capture"
        first_time_only = no

        [filter]
            [not]
                side = 1,2,3,4,5,6,7,8,9,18,19
            [/not]
            [filter_location]
                terrain = *^V*
            [/filter_location]
        [/filter]

        {PLAY_SOUND "torch.ogg"}
        {DELAY 200}
        {PLAY_SOUND "wose-die.ogg"}

        [terrain]
            x,y=$x1,$y1
            terrain=^Dr
            layer=overlay
        [/terrain]

        {REDRAW}
    [/event]

    # some follow up dialogue
    [event]
        name="side 2 turn 1"

        {SCROLL_TO_UNIT "Phaelyn"}

        {SIMPLE_MESSAGE "Phaelyn" ( _ "We may be surrounded from all fronts however, we have the entirety of our western flank stationed here.")}

        {SIMPLE_MESSAGE "Phaelyn" ( _ "Conquering us would not be so simple.")}

        {SCROLL_TO_UNIT "Mahir"}

        {SIMPLE_MESSAGE "Mahir" ( _ "Vampire! We have come to punish your wretched kind for enslaving us and using us for harvesting blood! There shall be a reckoning!")}

        {SCROLL_TO_UNIT "Phaelyn"}

        {SIMPLE_MESSAGE "Phaelyn" ( _ "Do not threaten us, blood-bag! We shall have you in chains again once we defeat our other adversaries.")}
    [/event]

    # demonic reinforcements
    [event]
        name="side 13 turn 2"

        {GENERIC_UNIT 14 "Demon Slashing Gale"  2 65}{ASSIGN_ID "gale001"}
        {GENERIC_UNIT 14 "Demon Slashing Gale"  6 65}{ASSIGN_ID "gale002"}
        {GENERIC_UNIT 14 "Demon Slashing Gale" 10 65}{ASSIGN_ID "gale003"}

        [micro_ai]
            side=14
            ai_type=boss
            action=add

            id="gale001"
            [filter_location]
                x,y=24-38,34-48
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=14
            ai_type=boss
            action=add

            id="gale002"
            [filter_location]
                x,y=24-38,34-48
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=14
            ai_type=boss
            action=add

            id="gale003"
            [filter_location]
                x,y=24-38,34-48
            [/filter_location]
        [/micro_ai]
    [/event]

    # evil reinforcements
    [event]
        name="side 15 turn 4"

        {GENERIC_UNIT 15 "Skeletal Dragon" 60 65}{ASSIGN_ID "hunter01"}
        [+unit]
            hitpoints=100
            max_hitpoints=100
            {IS_HERO}
            max_moves=8
        [/unit]
        {GENERIC_UNIT 15 "Skeletal Dragon" 48 65}{ASSIGN_ID "hunter02"}
        [+unit]
            hitpoints=100
            max_hitpoints=100
            {IS_HERO}
            max_moves=8
        [/unit]
        {GENERIC_UNIT 15 "Skeletal Dragon" 38 65}{ASSIGN_ID "hunter03"}
        [+unit]
            hitpoints=100
            max_hitpoints=100
            {IS_HERO}
            max_moves=8
        [/unit]

        [micro_ai]
            side=15
            ai_type=boss
            action=add

            id="hunter01"
            [filter_location]
                x,y=24-38,34-48
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=15
            ai_type=boss
            action=add

            id="hunter02"
            [filter_location]
                x,y=24-38,34-48
            [/filter_location]
        [/micro_ai]
        [micro_ai]
            side=15
            ai_type=boss
            action=add

            id="hunter03"
            [filter_location]
                x,y=24-38,34-48
            [/filter_location]
        [/micro_ai]
    [/event]

    # adding this on request from my friend
    [event]
        name="attack"
        first_time_only=yes
        [filter]
            id="Abrar"
        [/filter]

        {SIMPLE_MESSAGE "Abrar" ( _ "FOR PEANUTS!")}
    [/event]

    {TIME_OVER_DEFEAT}

    {MAIN_HERO_DEATH_EVENTS}
    {MAHIR_DEATH_EVENT}
    {KOJAC_LOYAL_DEATH_EVENT}
    {LOYAL_UNIT_DEATH_EVENT}

    # flavour events

    [event]
        name="attack"
        [filter]
            race="vampire"
        [/filter]
        [filter_second]
            id="Jahin"
        [/filter_second]

        {SIMPLE_MESSAGE "Jahin" ( _ "Are you challenging me, vampire?")}
    [/event]

    [event]
        name="attack"
        [filter]
            id="Jahin"
        [/filter]
        [filter_second]
            race="vampire"
        [/filter_second]

        {SIMPLE_MESSAGE "Jahin" ( _ "This is for all the years your wretched kind has incarcerated us!")}
    [/event]

    [event]
        name="attack"
        [filter]
            id="Mahir"
        [/filter]
        [filter_second]
            race="vampire"
        [/filter_second]

        {SIMPLE_MESSAGE "Mahir" ( _ "Ah, you shall be the subject of my vengeance!")}
    [/event]

    [event]
        name="attack"
        first_time_only=yes
        [filter]
            id="Krog"
        [/filter]
        [filter_second]
            race=vampire
        [/filter_second]

        {SIMPLE_MESSAGE "Krog" ( _ "Krog never forget. Krog never forget how Krog was treated by vampires!")}
    [/event]

    [event]
        name="attacker_hits"
        first_time_only=yes
        [filter]
            id="Krog"
        [/filter]
        [filter_second]
            race=vampire
        [/filter_second]

        {SIMPLE_MESSAGE "Krog" ( _ "Krog will smash all vampires!")}
    [/event]

    [event]
        name="last_breath"
        first_time_only=yes
        [filter]
            race=vampire
        [/filter]
        [filter_second]
            id="Krog"
        [/filter_second]

        {SIMPLE_MESSAGE "Meherab" ( _ "Yikes! Krog just hammered a vampire flat!")}

        {SIMPLE_MESSAGE "Mahir" ( _ "I expected no less from him. We are taking back our city and I do not care how many vampires I have to disintegrate to achieve that.")}
    [/event]

    

    # side 13 and 14 related
    [event]
        name="attack"
        first_time_only=yes
        [filter]
            side=1
        [/filter]
        [filter_second]
            side=13
        [/filter_second]

        {SIMPLE_MESSAGE "Jahin" ( _ "I had warned you once that if we met again, it would be as enemies.")}

        {SIMPLE_MESSAGE second_unit ( _ "We must conquer this city!")}

        {SIMPLE_MESSAGE "Jahin" ( _ "I am not letting your kind get near my city! Soldiers, quick! Dispatch them!")}
    [/event]

    [event]
        name="last breath"
        first_time_only=yes
        [filter]
            race=demon
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        {SIMPLE_MESSAGE "Mahir" ( _ "These demons are quite nimble, I must say!")}

        {SIMPLE_MESSAGE "Meherab" ( _ "Be glad it's dead now.")}
    [/event]

    # recruit event
    [event]
        name="recruit"
        first_time_only=yes
        [filter]
            side=1
            type="Adept of Light"
        [/filter]

        {REDRAW}

        {SIMPLE_MESSAGE "Mahir" ( _ "Since when did the mages join us?")}

        {SIMPLE_MESSAGE "Jahin" ( _ "Some mages have joined our ranks while we marched from the North. Most of them are graduate students who wish to see the world and they assume that joining us would be the best way to do it.")}
    [/event]

    # special event
    # might be triggered
    # by either side 1
    # or elves/dark elementals
    [event]
        name=attack
        first_time_only=yes
        [filter_second]
            id="Phaelyn"
        [/filter_second]
        [message]
            race=vampire
            message= _ "Protect the Duchess!"
        [/message]
        {LOYAL_UNIT 2 "Terror Hulk" $x1, $y1}{ASSIGN_ID "hulk01"}
        [micro_ai]
            side=2
            ai_type=boss
            action=add
            id="hulk01"
            [filter_location]
                x,y=32,40
                radius=5
            [/filter_location]
        [/micro_ai]
        {LOYAL_UNIT 2 "Terror Hulk" $x1, $y1}{ASSIGN_ID "hulk02"}
        [micro_ai]
            side=2
            ai_type=boss
            action=add
            id="hulk02"
            [filter_location]
                x,y=32,40
                radius=5
            [/filter_location]
        [/micro_ai]
        {LOYAL_UNIT 2 "Terror Hulk" $x1, $y1}{ASSIGN_ID "hulk03"}
        [micro_ai]
            side=2
            ai_type=boss
            action=add
            id="hulk03"
            [filter_location]
                x,y=32,40
                radius=5
            [/filter_location]
        [/micro_ai]
        {LOYAL_UNIT 2 "Terror Hulk" $x1, $y1}{ASSIGN_ID "hulk04"}
        [micro_ai]
            side=2
            ai_type=boss
            action=add
            id="hulk04"
            [filter_location]
                x,y=32,40
                radius=5
            [/filter_location]
        [/micro_ai]
        {LOYAL_UNIT 2 "Terror Hulk" $x1, $y1}{ASSIGN_ID "hulk05"}
        [micro_ai]
            side=2
            ai_type=boss
            action=add
            id="hulk05"
            [filter_location]
                x,y=32,40
                radius=5
            [/filter_location]
        [/micro_ai]
        {LOYAL_UNIT 2 "Terror Hulk" $x1, $y1}{ASSIGN_ID "hulk06"}
        [micro_ai]
            side=2
            ai_type=boss
            action=add
            id="hulk06"
            [filter_location]
                x,y=32,40
                radius=5
            [/filter_location]
        [/micro_ai]
    [/event]

    {~add-ons/War_of_Legends/macros/curse-global-events.cfg}

    {XP_GAINING_EVENT_JAHIN_SIDE}
    {RECALL_COST_CHANGE}
    {~add-ons/Hero_of_Irdya_I/macros/global-events.cfg}
[/scenario]
