#textdomain wesnoth-Hero_of_Irdya_I

[test]
    id="01_HoI_test_scenario"
    name= _ "Hero of Irdya I - Testing Scenario"

    map_file=data/add-ons/Hero_of_Irdya_I/maps/test/HoI1_test.map

    victory_when_enemies_defeated=no
    turns=-1

    {INDOORS}
    {DEFAULT_MUSIC_PLAYLIST}
    
    [side]
        side=1
        id="Jahin"
        name=_"Jahin"
        type=Warmaster
        unrenamable=yes
        canrecruit=yes
        controller=human
        [modifications]
            {TRAIT_FEARLESS}
            {TRAIT_INTELLIGENT}
            {TRAIT_QUICK}
        [/modifications]
        {FLAG_VARIANT loyalist}
        team_name="good"
        user_team_name= _ "Verdanyn"
        gold=0
        income=-2
        village_gold=0
    [/side]

    [side]
        side=2
        canrecruit=yes
        controller=ai
        {FLAG_VARIANT ragged}
        team_name="evil"
        hidden=yes
        type="Darkspawn Lord"
        id="Enemy_Leader"
        name= _ "Test Enemy Leader"
        user_team_name= _ "Evil"
        gold=0
        income=-2
        village_gold=0
    [/side]

    # preload event
    [event]
        name="preload"
        first_time_only=no

        # load the boss Micro AI
        [lua]
            code = << wesnoth.require "~add-ons/Hero_of_Irdya_I/ai/micro_ais/mai-defs/boss_mai.lua" >>
        [/lua]
    [/event]

    # prestart event
    [event]
        name="prestart"

        [objectives]
            side=1
            silent=no
            [objective]
                description=_"Observe"
            [/objective]
        [/objectives]

        # spawn boss unit

        {GENERIC_UNIT 2 "Clockwork Knight" 16 16}
        [+unit]
            id="level_boss"
            max_moves=4
            moves=4
            max_hitpoints=300
            hitpoints=300
            [status]
                invulnerable=yes
            [/status]
        [/unit]

        [micro_ai]
            side=2
            id="level_boss"
            ai_type=boss
            action=add
            [filter_location]
                x=16
                y=16
                radius=6
            [/filter_location]
            ca_id=HoI_level_boss_mai
            ca_score=400000
        [/micro_ai]

        # boss minions
        [repeat]
            times=6
            [do]
                {GENERIC_UNIT 2 "Clockwork Berserker" 16 16}
            [/do]
        [/repeat]

        # assign micro AI for the minions

        [micro_ai]
            side=2
            ai_type=zone_guardian
            action=add
            ca_id=HoI_level_boss_minions_mai
            [filter]
                type="Clockwork Berserker"
            [/filter]
            [filter_location]
                x,y=16,16
                radius=6
            [/filter_location]
            ca_score=200000
        [/micro_ai]
    [/event]

    # unit placed

    [event]
        name="moveto"
        first_time_only=no

        [filter]
            id="level_boss"
        [/filter]

        [store_unit]
            [filter]
                id="level_boss"
            [/filter]
            variable=scenario_boss
            kill=no
        [/store_unit]

        [micro_ai]
            side=2
            ai_type=zone_guardian
            action=change
            ca_id=HoI_level_boss_minions_mai
            [filter]
                type="Clockwork Berserker"
            [/filter]
            [filter_location]
                x=$scenario_boss.$x1
                y=$scenario_boss.$y1
                radius=3
            [/filter_location]
            ca_score=200000
        [/micro_ai]

        {CLEAR_VARIABLE scenario_boss}
    [/event]
[/test]